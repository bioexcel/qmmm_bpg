<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Understanding the CP2K output &mdash; (GROMACS+)CP2K QM/MM Best Practice Guide  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CP2K Troubleshooting" href="cp2k_errors.html" />
    <link rel="prev" title="Running QM/MM simulations" href="running_cp2k.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> (GROMACS+)CP2K QM/MM Best Practice Guide
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/overview.html">QM/MM overview</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">System preparation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../system_preparation/system_preparation.html">System preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system_preparation/selecting_qm_atoms.html">Selecting QM atoms</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input preparation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../input_preparation/CP2K_MM_setup.html">CP2K MM setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_preparation/QM_treatment.html">QM treatment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_preparation/CP2K_QMMM_parameterisation.html">CP2K QM/MM parameterisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_preparation/interface_QMMM_parameterisation.html">GROMACS/CP2K interface QM/MM parameterisation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Running:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="building_cp2k.html">Building CP2K</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_cp2k.html">Running QM/MM simulations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Understanding the CP2K output</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general-output">General Output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#standard-output">Standard output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wavefuntions-name-restart-wfn">Wavefuntions - NAME-RESTART.wfn</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#output-from-an-md-run">Output from an MD run</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ener-file">.ener file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#md-trajectory">MD trajectory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restart-file">.restart file</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cp2k_errors.html">CP2K Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">(GROMACS+)CP2K QM/MM Best Practice Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Understanding the CP2K output</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/running_cp2k/cp2k_output.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="understanding-the-cp2k-output">
<h1>Understanding the CP2K output<a class="headerlink" href="#understanding-the-cp2k-output" title="Permalink to this heading"></a></h1>
<section id="general-output">
<h2>General Output<a class="headerlink" href="#general-output" title="Permalink to this heading"></a></h2>
<section id="standard-output">
<h3>Standard output<a class="headerlink" href="#standard-output" title="Permalink to this heading"></a></h3>
<p>The beginning of the standard output contains information about the setup of the run.
This will  print the important input parameters and details of how CP2K was built and run
e.g. the number of processes and threads that were specifed when running. It can be
used for future reference.</p>
<p>After this part, the output will then print details of the individual setup for the important
sections in the input file. These will appear under clear headings e.g. FIST for the MM section,
Quickstep for the DFT section, and QMMM. Input parameters are reported, along with some more information
such as for example the number of basis functions.</p>
<p>The report of the calculation then follows in the output file. It will start with the
results from the self-consistent Kohn-Sham ground state calculation (SCF optimisation).
This will look similar to the snippet below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>SCF WAVEFUNCTION OPTIMIZATION

 ----------------------------------- OT ---------------------------------------
 Minimizer      : DIIS                : direct inversion
                                        in the iterative subspace
                                        using   7 DIIS vectors
                                        safer DIIS on
 Preconditioner : FULL_ALL            : diagonalization, state selective
 Precond_solver : DEFAULT
 stepsize       :    0.15000000                  energy_gap     :    0.08000000
 eps_taylor     :   0.10000E-15                  max_taylor     :             4
 ----------------------------------- OT ---------------------------------------

 Step     Update method      Time    Convergence         Total energy    Change
 ------------------------------------------------------------------------------
 Decoupling Energy:                                              -0.0015860332
 Recoupling Energy:                                               0.0000002197
    1 OT DIIS     0.15E+00 1261.9     0.00000101      -412.4425164003 -4.12E+02
 Decoupling Energy:                                              -0.0015862541
 Recoupling Energy:                                               0.0000002197
    2 OT DIIS     0.15E+00    1.0     0.00000216      -412.4425163985  1.73E-09
 Decoupling Energy:                                              -0.0015860586
 Recoupling Energy:                                               0.0000002197
    3 OT DIIS     0.15E+00    1.0     0.00000051      -412.4425164055 -6.98E-09
</pre></div>
</div>
<p>The OT block prints information about the orbital transform solver. This again,
reports the options set in the input file.</p>
<p>The SCF steps are then printed as they are calculated, listing the Step number, Method,
run Time, Convergence, Total Energy and the Change in energy from the last step.
The first step will usually take longer as there are set up overheads.</p>
<p>In an ideal calculation the Total Energy should decrease with each step
as the energy is minimised (this means the Change should be negeative).
The Change in energy should also decrease as it converges to the final value.
The Convergence gives an idea of the accuracy of the SCF energy. When this value
becomes less than the <code class="docutils literal notranslate"><span class="pre">EPS_SCF</span></code> value specified in the input the SCF calculation will
exit and a message stating that convergence has been acheived is printed.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>*** SCF run converged in     3 steps ***
</pre></div>
</div>
<p>Otherwise, if the SCF does not converge, it continues until the number of steps equals the MAX_SCF in the
input file. The inner SCF loop will finish and then move to the next outer SCF step,
recalculating the preconditioner. Finally, if the number of outer SCF steps equals to
the corresponding <code class="docutils literal notranslate"><span class="pre">MAX_SCF</span></code> value in the input file, then the SCF calculation has not converged,
a warning will be printed to the standard output and the SCF will be abandoned.
Information on how to handle this is given in the troubleshooting chapter.</p>
<p>Upon successful convergence, electronic densities and energies (and forces if specified) information is printed.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Electronic density on regular grids:       -213.9999999972        0.0000000028
Core density on regular grids:              213.9999999999       -0.0000000001
Total charge density on r-space grids:        0.0000000026
Total charge density g-space grids:           0.0000000026

Overlap energy of the core charge distribution:               0.00000923326382
Self energy of the core charge distribution:               -943.25295781363013
Core Hamiltonian energy:                                    284.50150313570356
Hartree energy:                                             355.46908698187769
Exchange-correlation energy:                                -85.84000086143999
Hartree-Fock Exchange energy:                               -18.79624573644062
QM/MM Electrostatic energy:                                  -4.52391134484379

Total energy:                                              -412.44251640550942

outer SCF iter =    1 RMS gradient =   0.51E-06 energy =       -412.4425164055
outer SCF loop converged in   1 iterations or    3 steps


ENERGY| Total FORCE_EVAL ( QMMM ) energy (a.u.):          -2134.963290942846925
</pre></div>
</div>
<p>It is a good idea to check that the electronic density corresponds to the number of
electrons, and that the charge is as expected.</p>
<p>The Total energy given is the energy from only the QM part i.e from the SCF calculation.
A breakdown of its components is printed above it. The total number of outer SCF loops
and inner SCF steps that were done is also shown.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ENERGY</span> <span class="pre">(QMMM)`</span></code> is the QM/MM energy including all its components; the QM energy, MM energy
and QM-MM interation energy. This is the energy you are usually interested in.</p>
</section>
<section id="wavefuntions-name-restart-wfn">
<h3>Wavefuntions - NAME-RESTART.wfn<a class="headerlink" href="#wavefuntions-name-restart-wfn" title="Permalink to this heading"></a></h3>
<p>Wavefunction files are binary files that contain the wavefunctions obtained from the last SCF step.
They are named with the project_name preceeding <code class="docutils literal notranslate"><span class="pre">'-RESTART.wfn'</span></code>.
One is written every SCF step, and if a wavefuntion file of the same name
already exists the older version is moved to <code class="docutils literal notranslate"><span class="pre">NAME-RESTART.wfn.bak-1</span></code>, rather than overwritten.
This is done for up to three files and so you may see the following files, where
the third backup (bak-3) is the oldest.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>NAME-RESTART.wfn
NAME-RESTART.wfn.bak-1
NAME-RESTART.wfn.bak-2
NAME-RESTART.wfn.bak-3
</pre></div>
</div>
<p>Wavefunction restarts are  used when restarting a calculation in order to act
as a guide for the first SCF step to speed up the calculation.
In this case the project name should be consistent
and the <code class="docutils literal notranslate"><span class="pre">SCF_GUESS</span></code> should be set to ‘restart’. Care should be taken that
the wavefunction is a suitable guess for the SCF calculation otherwise it may not
converge.</p>
</section>
</section>
<section id="output-from-an-md-run">
<h2>Output from an MD run<a class="headerlink" href="#output-from-an-md-run" title="Permalink to this heading"></a></h2>
<section id="ener-file">
<h3>.ener file<a class="headerlink" href="#ener-file" title="Permalink to this heading"></a></h3>
<p>The .ener file shows the important information about the system as the simulation
progresses. For each step the Temperature, Kinetic energy, Potential energy, CPU time
and the Conserved Quantity are printed. The Conserved Quantity can represent different
quantities according to the statistical ensemble we are sampling on. For example, if we
are running an NVE simulation the Conserved Quantity corresponds to the total energy of
the system of interest, while if we run an NVT simulation then the Conserved Quantity
is the total energy of a system that includes the system of interest and also the
thermostat degrees of freedom.</p>
</section>
<section id="md-trajectory">
<h3>MD trajectory<a class="headerlink" href="#md-trajectory" title="Permalink to this heading"></a></h3>
<p>This will look similar to the geometry trajectory from a geometry optimation and
will appear as a .xyz file as default. The coordinates at each MD step are printed in order
in this file. You can control how often this file is updated with new coordinates by using the
following settings within the motion section:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;MOTION
   &amp;PRINT
      &amp;TRAJECTORY
        &amp;EACH
           MD 10                       ! print every 10 steps
        &amp;END EACH
      &amp;END TRAJECTORY
   &amp;END PRINT
&amp;END MOTION
</pre></div>
</div>
</section>
<section id="restart-file">
<h3>.restart file<a class="headerlink" href="#restart-file" title="Permalink to this heading"></a></h3>
<p>The .restart file is written at the end of an MD step and it contains the information
to restart the MD simulation from that step. This file is human readable and reports information about the system
setup along with the current positions and velocities of the atoms in the system.</p>
<p>To restart an MD simulation the <code class="docutils literal notranslate"><span class="pre">EXT_RESTART</span></code> section has to be added to the input file to instruct the code
to use the .restart file as the restart point:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;EXT_RESTART
   EXTERNAL_FILE_NAME  project-1.restart
&amp;END EXT_RESTART
</pre></div>
</div>
<p>You can also use the <code class="docutils literal notranslate"><span class="pre">.restart</span></code> file as if the input file for restarting the simulation,
supplying it directly to the CP2K executable in the job submission script:</p>
<p><code class="docutils literal notranslate"><span class="pre">cp2k.psmp</span> <span class="pre">–i</span> <span class="pre">project-1.restart</span></code></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="running_cp2k.html" class="btn btn-neutral float-left" title="Running QM/MM simulations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cp2k_errors.html" class="btn btn-neutral float-right" title="CP2K Troubleshooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>